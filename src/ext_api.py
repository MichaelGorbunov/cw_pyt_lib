# https://www.cbr-xml-daily.ru/daily_json.js
from config import DATA_DIR, LOGS_DIR, ROOT_DIR, url, url_stocks
import logging
import os
import json
import requests
logger = logging.getLogger("ext_api")
logger_file_handler = logging.FileHandler(os.path.join(LOGS_DIR, "ext_api.log"), encoding="utf8", mode="a")
logger_formatter = logging.Formatter("%(asctime)s - %(levelname)s - FUNC(%(funcName)s): %(message)s")
logger_file_handler.setFormatter(logger_formatter)
logger.addHandler(logger_file_handler)
logger.setLevel(logging.INFO)

# response = requests.get("https://www.cbr-xml-daily.ru/daily_json.js")
# logger.info(response)
# response_json = response.json()
# logger.info(response_json)
# data = '{"Date": "2024-06-25T11:30:00+03:00", "PreviousDate": "2024-06-22T11:30:00+03:00", "PreviousURL": "//www.cbr-xml-daily.ru/archive/2024/06/22/daily_json.js", "Timestamp": "2024-06-25T16:00:00+03:00", "Valute": {"AUD": {"ID": "R01010", "NumCode": "036", "CharCode": "AUD", "Nominal": 1, "Name": "Австралийский доллар", "Value": 58.0244, "Previous": 58.625}, "AZN": {"ID": "R01020A", "NumCode": "944", "CharCode": "AZN", "Nominal": 1, "Name": "Азербайджанский манат", "Value": 51.3959, "Previous": 51.7409}, "GBP": {"ID": "R01035", "NumCode": "826", "CharCode": "GBP", "Nominal": 1, "Name": "Фунт стерлингов Соединенного королевства", "Value": 110.3171, "Previous": 111.5854}, "AMD": {"ID": "R01060", "NumCode": "051", "CharCode": "AMD", "Nominal": 100, "Name": "Армянских драмов", "Value": 22.5159, "Previous": 22.6396}, "BYN": {"ID": "R01090B", "NumCode": "933", "CharCode": "BYN", "Nominal": 1, "Name": "Белорусский рубль", "Value": 27.1572, "Previous": 27.2683}, "BGN": {"ID": "R01100", "NumCode": "975", "CharCode": "BGN", "Nominal": 1, "Name": "Болгарский лев", "Value": 47.7466, "Previous": 48.2065}, "BRL": {"ID": "R01115", "NumCode": "986", "CharCode": "BRL", "Nominal": 1, "Name": "Бразильский реал", "Value": 16.0574, "Previous": 16.2134}, "HUF": {"ID": "R01135", "NumCode": "348", "CharCode": "HUF", "Nominal": 100, "Name": "Венгерских форинтов", "Value": 23.67, "Previous": 23.6501}, "VND": {"ID": "R01150", "NumCode": "704", "CharCode": "VND", "Nominal": 10000, "Name": "Вьетнамских донгов", "Value": 36.0123, "Previous": 36.263}, "HKD": {"ID": "R01200", "NumCode": "344", "CharCode": "HKD", "Nominal": 1, "Name": "Гонконгский доллар", "Value": 11.2117, "Previous": 11.2928}, "GEL": {"ID": "R01210", "NumCode": "981", "CharCode": "GEL", "Nominal": 1, "Name": "Грузинский лари", "Value": 31.2035, "Previous": 31.413}, "DKK": {"ID": "R01215", "NumCode": "208", "CharCode": "DKK", "Nominal": 1, "Name": "Датская крона", "Value": 12.5214, "Previous": 12.6419}, "AED": {"ID": "R01230", "NumCode": "784", "CharCode": "AED", "Nominal": 1, "Name": "Дирхам ОАЭ", "Value": 23.7912, "Previous": 23.9509}, "USD": {"ID": "R01235", "NumCode": "840", "CharCode": "USD", "Nominal": 1, "Name": "Доллар США", "Value": 87.373, "Previous": 87.9595}, "EUR": {"ID": "R01239", "NumCode": "978", "CharCode": "EUR", "Nominal": 1, "Name": "Евро", "Value": 94.0759, "Previous": 94.2606}, "EGP": {"ID": "R01240", "NumCode": "818", "CharCode": "EGP", "Nominal": 10, "Name": "Египетских фунтов", "Value": 18.0825, "Previous": 18.4366}, "INR": {"ID": "R01270", "NumCode": "356", "CharCode": "INR", "Nominal": 10, "Name": "Индийских рупий", "Value": 10.4621, "Previous": 10.5232}, "IDR": {"ID": "R01280", "NumCode": "360", "CharCode": "IDR", "Nominal": 10000, "Name": "Индонезийских рупий", "Value": 53.0885, "Previous": 53.5685}, "KZT": {"ID": "R01335", "NumCode": "398", "CharCode": "KZT", "Nominal": 100, "Name": "Казахстанских тенге", "Value": 18.8012, "Previous": 19.1383}, "CAD": {"ID": "R01350", "NumCode": "124", "CharCode": "CAD", "Nominal": 1, "Name": "Канадский доллар", "Value": 63.7666, "Previous": 64.2134}, "QAR": {"ID": "R01355", "NumCode": "634", "CharCode": "QAR", "Nominal": 1, "Name": "Катарский риал", "Value": 24.0036, "Previous": 24.1647}, "KGS": {"ID": "R01370", "NumCode": "417", "CharCode": "KGS", "Nominal": 10, "Name": "Киргизских сомов", "Value": 10.0784, "Previous": 10.1384}, "CNY": {"ID": "R01375", "NumCode": "156", "CharCode": "CNY", "Nominal": 1, "Name": "Китайский юань", "Value": 11.8582, "Previous": 12.0455}, "MDL": {"ID": "R01500", "NumCode": "498", "CharCode": "MDL", "Nominal": 10, "Name": "Молдавских леев", "Value": 48.8254, "Previous": 49.2285}, "NZD": {"ID": "R01530", "NumCode": "554", "CharCode": "NZD", "Nominal": 1, "Name": "Новозеландский доллар", "Value": 53.3805, "Previous": 53.8576}, "NOK": {"ID": "R01535", "NumCode": "578", "CharCode": "NOK", "Nominal": 10, "Name": "Норвежских крон", "Value": 82.8722, "Previous": 83.4998}, "PLN": {"ID": "R01565", "NumCode": "985", "CharCode": "PLN", "Nominal": 1, "Name": "Польский злотый", "Value": 21.6704, "Previous": 21.7039}, "RON": {"ID": "R01585F", "NumCode": "946", "CharCode": "RON", "Nominal": 1, "Name": "Румынский лей", "Value": 18.7758, "Previous": 18.9018}, "XDR": {"ID": "R01589", "NumCode": "960", "CharCode": "XDR", "Nominal": 1, "Name": "СДР (специальные права заимствования)", "Value": 114.8911, "Previous": 115.8928}, "SGD": {"ID": "R01625", "NumCode": "702", "CharCode": "SGD", "Nominal": 1, "Name": "Сингапурский доллар", "Value": 64.4867, "Previous": 64.9867}, "TJS": {"ID": "R01670", "NumCode": "972", "CharCode": "TJS", "Nominal": 10, "Name": "Таджикских сомони", "Value": 82.0103, "Previous": 82.6858}, "THB": {"ID": "R01675", "NumCode": "764", "CharCode": "THB", "Nominal": 10, "Name": "Таиландских батов", "Value": 23.7905, "Previous": 23.9626}, "TRY": {"ID": "R01700J", "NumCode": "949", "CharCode": "TRY", "Nominal": 10, "Name": "Турецких лир", "Value": 26.6296, "Previous": 26.9811}, "TMT": {"ID": "R01710A", "NumCode": "934", "CharCode": "TMT", "Nominal": 1, "Name": "Новый туркменский манат", "Value": 24.9637, "Previous": 25.1313}, "UZS": {"ID": "R01717", "NumCode": "860", "CharCode": "UZS", "Nominal": 10000, "Name": "Узбекских сумов", "Value": 69.2053, "Previous": 69.5893}, "UAH": {"ID": "R01720", "NumCode": "980", "CharCode": "UAH", "Nominal": 10, "Name": "Украинских гривен", "Value": 21.6014, "Previous": 21.7085}, "CZK": {"ID": "R01760", "NumCode": "203", "CharCode": "CZK", "Nominal": 10, "Name": "Чешских крон", "Value": 37.6673, "Previous": 37.6845}, "SEK": {"ID": "R01770", "NumCode": "752", "CharCode": "SEK", "Nominal": 10, "Name": "Шведских крон", "Value": 83.6356, "Previous": 84.197}, "CHF": {"ID": "R01775", "NumCode": "756", "CharCode": "CHF", "Nominal": 1, "Name": "Швейцарский франк", "Value": 97.7436, "Previous": 98.6093}, "RSD": {"ID": "R01805F", "NumCode": "941", "CharCode": "RSD", "Nominal": 100, "Name": "Сербских динаров", "Value": 79.8633, "Previous": 80.5573}, "ZAR": {"ID": "R01810", "NumCode": "710", "CharCode": "ZAR", "Nominal": 10, "Name": "Южноафриканских рэндов", "Value": 48.3349, "Previous": 48.9823}, "KRW": {"ID": "R01815", "NumCode": "410", "CharCode": "KRW", "Nominal": 1000, "Name": "Вон Республики Корея", "Value": 62.9035, "Previous": 63.3577}, "JPY": {"ID": "R01820", "NumCode": "392", "CharCode": "JPY", "Nominal": 100, "Name": "Японских иен", "Value": 54.673, "Previous": 55.3204}}}'
data='{'Date': '2024-06-25T11:30:00+03:00', 'PreviousDate': '2024-06-22T11:30:00+03:00', 'PreviousURL': '//www.cbr-xml-daily.ru/archive/2024/06/22/daily_json.js', 'Timestamp': '2024-06-25T16:00:00+03:00', 'Valute': {'AUD': {'ID': 'R01010', 'NumCode': '036', 'CharCode': 'AUD', 'Nominal': 1, 'Name': 'Австралийский доллар', 'Value': 58.0244, 'Previous': 58.625}, 'AZN': {'ID': 'R01020A', 'NumCode': '944', 'CharCode': 'AZN', 'Nominal': 1, 'Name': 'Азербайджанский манат', 'Value': 51.3959, 'Previous': 51.7409}, 'GBP': {'ID': 'R01035', 'NumCode': '826', 'CharCode': 'GBP', 'Nominal': 1, 'Name': 'Фунт стерлингов Соединенного королевства', 'Value': 110.3171, 'Previous': 111.5854}, 'AMD': {'ID': 'R01060', 'NumCode': '051', 'CharCode': 'AMD', 'Nominal': 100, 'Name': 'Армянских драмов', 'Value': 22.5159, 'Previous': 22.6396}, 'BYN': {'ID': 'R01090B', 'NumCode': '933', 'CharCode': 'BYN', 'Nominal': 1, 'Name': 'Белорусский рубль', 'Value': 27.1572, 'Previous': 27.2683}, 'BGN': {'ID': 'R01100', 'NumCode': '975', 'CharCode': 'BGN', 'Nominal': 1, 'Name': 'Болгарский лев', 'Value': 47.7466, 'Previous': 48.2065}, 'BRL': {'ID': 'R01115', 'NumCode': '986', 'CharCode': 'BRL', 'Nominal': 1, 'Name': 'Бразильский реал', 'Value': 16.0574, 'Previous': 16.2134}, 'HUF': {'ID': 'R01135', 'NumCode': '348', 'CharCode': 'HUF', 'Nominal': 100, 'Name': 'Венгерских форинтов', 'Value': 23.67, 'Previous': 23.6501}, 'VND': {'ID': 'R01150', 'NumCode': '704', 'CharCode': 'VND', 'Nominal': 10000, 'Name': 'Вьетнамских донгов', 'Value': 36.0123, 'Previous': 36.263}, 'HKD': {'ID': 'R01200', 'NumCode': '344', 'CharCode': 'HKD', 'Nominal': 1, 'Name': 'Гонконгский доллар', 'Value': 11.2117, 'Previous': 11.2928}, 'GEL': {'ID': 'R01210', 'NumCode': '981', 'CharCode': 'GEL', 'Nominal': 1, 'Name': 'Грузинский лари', 'Value': 31.2035, 'Previous': 31.413}, 'DKK': {'ID': 'R01215', 'NumCode': '208', 'CharCode': 'DKK', 'Nominal': 1, 'Name': 'Датская крона', 'Value': 12.5214, 'Previous': 12.6419}, 'AED': {'ID': 'R01230', 'NumCode': '784', 'CharCode': 'AED', 'Nominal': 1, 'Name': 'Дирхам ОАЭ', 'Value': 23.7912, 'Previous': 23.9509}, 'USD': {'ID': 'R01235', 'NumCode': '840', 'CharCode': 'USD', 'Nominal': 1, 'Name': 'Доллар США', 'Value': 87.373, 'Previous': 87.9595}, 'EUR': {'ID': 'R01239', 'NumCode': '978', 'CharCode': 'EUR', 'Nominal': 1, 'Name': 'Евро', 'Value': 94.0759, 'Previous': 94.2606}, 'EGP': {'ID': 'R01240', 'NumCode': '818', 'CharCode': 'EGP', 'Nominal': 10, 'Name': 'Египетских фунтов', 'Value': 18.0825, 'Previous': 18.4366}, 'INR': {'ID': 'R01270', 'NumCode': '356', 'CharCode': 'INR', 'Nominal': 10, 'Name': 'Индийских рупий', 'Value': 10.4621, 'Previous': 10.5232}, 'IDR': {'ID': 'R01280', 'NumCode': '360', 'CharCode': 'IDR', 'Nominal': 10000, 'Name': 'Индонезийских рупий', 'Value': 53.0885, 'Previous': 53.5685}, 'KZT': {'ID': 'R01335', 'NumCode': '398', 'CharCode': 'KZT', 'Nominal': 100, 'Name': 'Казахстанских тенге', 'Value': 18.8012, 'Previous': 19.1383}, 'CAD': {'ID': 'R01350', 'NumCode': '124', 'CharCode': 'CAD', 'Nominal': 1, 'Name': 'Канадский доллар', 'Value': 63.7666, 'Previous': 64.2134}, 'QAR': {'ID': 'R01355', 'NumCode': '634', 'CharCode': 'QAR', 'Nominal': 1, 'Name': 'Катарский риал', 'Value': 24.0036, 'Previous': 24.1647}, 'KGS': {'ID': 'R01370', 'NumCode': '417', 'CharCode': 'KGS', 'Nominal': 10, 'Name': 'Киргизских сомов', 'Value': 10.0784, 'Previous': 10.1384}, 'CNY': {'ID': 'R01375', 'NumCode': '156', 'CharCode': 'CNY', 'Nominal': 1, 'Name': 'Китайский юань', 'Value': 11.8582, 'Previous': 12.0455}, 'MDL': {'ID': 'R01500', 'NumCode': '498', 'CharCode': 'MDL', 'Nominal': 10, 'Name': 'Молдавских леев', 'Value': 48.8254, 'Previous': 49.2285}, 'NZD': {'ID': 'R01530', 'NumCode': '554', 'CharCode': 'NZD', 'Nominal': 1, 'Name': 'Новозеландский доллар', 'Value': 53.3805, 'Previous': 53.8576}, 'NOK': {'ID': 'R01535', 'NumCode': '578', 'CharCode': 'NOK', 'Nominal': 10, 'Name': 'Норвежских крон', 'Value': 82.8722, 'Previous': 83.4998}, 'PLN': {'ID': 'R01565', 'NumCode': '985', 'CharCode': 'PLN', 'Nominal': 1, 'Name': 'Польский злотый', 'Value': 21.6704, 'Previous': 21.7039}, 'RON': {'ID': 'R01585F', 'NumCode': '946', 'CharCode': 'RON', 'Nominal': 1, 'Name': 'Румынский лей', 'Value': 18.7758, 'Previous': 18.9018}, 'XDR': {'ID': 'R01589', 'NumCode': '960', 'CharCode': 'XDR', 'Nominal': 1, 'Name': 'СДР (специальные права заимствования)', 'Value': 114.8911, 'Previous': 115.8928}, 'SGD': {'ID': 'R01625', 'NumCode': '702', 'CharCode': 'SGD', 'Nominal': 1, 'Name': 'Сингапурский доллар', 'Value': 64.4867, 'Previous': 64.9867}, 'TJS': {'ID': 'R01670', 'NumCode': '972', 'CharCode': 'TJS', 'Nominal': 10, 'Name': 'Таджикских сомони', 'Value': 82.0103, 'Previous': 82.6858}, 'THB': {'ID': 'R01675', 'NumCode': '764', 'CharCode': 'THB', 'Nominal': 10, 'Name': 'Таиландских батов', 'Value': 23.7905, 'Previous': 23.9626}, 'TRY': {'ID': 'R01700J', 'NumCode': '949', 'CharCode': 'TRY', 'Nominal': 10, 'Name': 'Турецких лир', 'Value': 26.6296, 'Previous': 26.9811}, 'TMT': {'ID': 'R01710A', 'NumCode': '934', 'CharCode': 'TMT', 'Nominal': 1, 'Name': 'Новый туркменский манат', 'Value': 24.9637, 'Previous': 25.1313}, 'UZS': {'ID': 'R01717', 'NumCode': '860', 'CharCode': 'UZS', 'Nominal': 10000, 'Name': 'Узбекских сумов', 'Value': 69.2053, 'Previous': 69.5893}, 'UAH': {'ID': 'R01720', 'NumCode': '980', 'CharCode': 'UAH', 'Nominal': 10, 'Name': 'Украинских гривен', 'Value': 21.6014, 'Previous': 21.7085}, 'CZK': {'ID': 'R01760', 'NumCode': '203', 'CharCode': 'CZK', 'Nominal': 10, 'Name': 'Чешских крон', 'Value': 37.6673, 'Previous': 37.6845}, 'SEK': {'ID': 'R01770', 'NumCode': '752', 'CharCode': 'SEK', 'Nominal': 10, 'Name': 'Шведских крон', 'Value': 83.6356, 'Previous': 84.197}, 'CHF': {'ID': 'R01775', 'NumCode': '756', 'CharCode': 'CHF', 'Nominal': 1, 'Name': 'Швейцарский франк', 'Value': 97.7436, 'Previous': 98.6093}, 'RSD': {'ID': 'R01805F', 'NumCode': '941', 'CharCode': 'RSD', 'Nominal': 100, 'Name': 'Сербских динаров', 'Value': 79.8633, 'Previous': 80.5573}, 'ZAR': {'ID': 'R01810', 'NumCode': '710', 'CharCode': 'ZAR', 'Nominal': 10, 'Name': 'Южноафриканских рэндов', 'Value': 48.3349, 'Previous': 48.9823}, 'KRW': {'ID': 'R01815', 'NumCode': '410', 'CharCode': 'KRW', 'Nominal': 1000, 'Name': 'Вон Республики Корея', 'Value': 62.9035, 'Previous': 63.3577}, 'JPY': {'ID': 'R01820', 'NumCode': '392', 'CharCode': 'JPY', 'Nominal': 100, 'Name': 'Японских иен', 'Value': 54.673, 'Previous': 55.3204}}}'
# parsed_data - словарь, тип dict
parsed_data = json.loads(data)

# Получаем значение словаря по ключу
print(parsed_data["Date"])